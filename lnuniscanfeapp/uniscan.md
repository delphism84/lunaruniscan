## UniScan FE/BE 湲곕뒫 援ъ꽦 臾몄꽌

李멸퀬: ?꾩껜 援ъ“/?곸꽭 ?ㅺ퀎??`uniscan-structure.md`瑜??뺤씤?섏꽭??

### 二쇱슂 ?먮쫫 ?붿빟(?붽뎄?ы빆 ?뺣━)
- Barcode ?ㅼ틪 ???몄떇 ?대깽????罹먯떛(諛붿퐫?? ?깅줉
- Camera 珥ъ쁺 ??珥ъ쁺 ?대깽????罹먯떛(?ъ쭊) ?깅줉

### 肄붾뱶1: 諛붿퐫???ㅼ틪 ?쇱씠釉뚮윭由??ъ슜(?꾩옱 ?숈옉 + 怨꾪쉷)
- ?ъ슜 ?쇱씠釉뚮윭由? `mobile_scanner`
- 諛붿퐫?? `MobileScanner.onDetect ??ScanService.onBarcodeDetected ??EnhancedScanService.addBarcode`
- 移대찓?? Camera ??뿉??珥ъ쁺 踰꾪듉 ??`ScanService.captureImage ??EnhancedScanService.addImagePlaceholder`
  - ???곹깭: ?ㅼ젣 ?뚯씪 ????놁씠 placeholder ?깅줉
  - 怨꾪쉷: ?ㅼ젣 珥ъ쁺 ?뚯씪 ????먮뒗 ?좏깮) ??罹먯떛 ?쒕퉬?ㅼ뿉 ?뚯씪 寃쎈줈 ?꾨떖

### 肄붾뱶2: 罹먯떛 愿由??꾩옱 ?숈옉 + 怨꾪쉷)
- ???곹깭(硫붾え由?罹먯떆):
  - `EnhancedScanService`媛 `IScanItem` 紐⑸줉(諛붿퐫???대?吏)??硫붾え由ъ뿉 ?좎?
  - 以묐났 諛붿퐫???꾪꽣(湲곕낯 5珥?: ?숈씪 諛붿퐫???곗냽 ?몄떇 諛⑹?, ?ㅼ젙/珥덇린??媛??
- 怨꾪쉷(?뚯씪 罹먯떆 + ?낅줈??:
  - 罹먯떛 ?깅줉: ?ㅼ틪 ?꾩씠?쒖쓣 ?뚯씪濡??앹꽦/蹂닿?
    - type: `barcode | image`
    - content: 諛붿퐫???띿뒪???먮뒗 ?대?吏 ?뚯씪(`png/jpg`)
  - 罹먯떛 ?낅줈?? BE API濡??꾨떖?섎ŉ 吏꾪뻾瑜??쒖떆
    - ?깃났: 罹먯떆 ?뚯씪 ??젣, 湲곕줉留?蹂댁〈
    - ?ㅽ뙣: ?ъ떆??諛깆삤?? ?ㅽ뙣 湲곕줉 ?좎?

### UniScanAgent 愿由??꾨윴?몄뿏??
- BE?먯꽌 ?깅줉???먯씠?꾪듃(PC ?ㅼ튂?? 紐⑸줉 議고쉶/?쒖떆
- 諛붿퐫?????泥섎━ ?? ?ъ슜???좏깮(ON)???먯씠?꾪듃濡??꾨떖?????덈룄濡??쇱슦???ㅼ젙

### 諛깆뿏??泥섎━ ?먯튃(??낅퀎)
- ?대?吏 ???
  - ???寃쎈줈: `BE ?ㅽ뻾 ?대뜑/files/images/{userId}/{yyyyMMdd}/{yyyyMMdd-HHmmss_?쒕뜡}.jpg`
  - DB 湲곕줉(硫뷀?: userId, ?뚯씪 寃쎈줈, ?낅줈???쒓컖, ?곹깭)
  - ???④퀎: ?ш린源뚯? 援ы쁽 ???댄썑??TODO濡??④?
- 諛붿퐫?????
  - DB 湲곕줉(?곗씠?? userId, ?쒓컖, ?곹깭)
  - ?먯씠?꾪듃 ON ?곹깭????곸뿉寃?WS ?몄뀡?쇰줈 ?꾩넚
  - ?꾩넚 ?꾨즺 ??DB ack 媛깆떊

### UniScanAgent(?붽뎄?ы빆)
- C# .NET Framework 4.x
- ?꾩뿭 ?꾪궧(?ㅻ낫??留덉슦??
- BE?먯꽌 scanitem ?섏떊 ???ㅻ낫???낅젰 ?좏샇濡??대낫??諛붿퐫???ㅼ틦???④낵 ?쒓났
- ?④낵???ъ깮(Agent ??ON/OFF), 醫뚯륫?섎떒 ?먯껜 ?좎뒪??ON/OFF)
- Tray ?꾩씠肄? Inno Setup ?ㅼ튂, ?쒕퉬?ㅻ줈 援щ룞


### 紐⑹쟻
UniScan ?쒖뒪?쒖쓽 ?꾨윴?몄뿏??Flutter)? 諛깆뿏??.NET) 援ъ꽦, ?곗씠???먮쫫, API/HUB ?ъ뼇, ?ㅽ뻾 諛⑸쾿????臾몄꽌???뺣━?쒕떎.

## ?꾨윴?몄뿏??Flutter)

### ?고????ы듃
- FE 媛쒕컻 ?쒕쾭: http://127.0.0.1:58000 (?ъ슜???좏샇 ?ㅼ젙)
- 媛쒕컻 ?쒕쾭 IP : 175.100.115.114

### 二쇱슂 ?섏〈??
- 移대찓??諛붿퐫?? mobile_scanner ?뚮윭洹몄씤 ?ъ슜. ?⑥씪 ?꾩젽 湲곕컲 ?⑥닚 援ъ“濡?援ы쁽?? [紐⑤뱢 臾몄꽌](https://pub.dev/packages/mobile_scanner)

### ?붾㈃/UX 援ъ꽦
- ?⑥씪 移대찓??誘몃━蹂닿린 ?덉씠?꾩썐 ?곷떒(Expanded) 怨좎젙
- ?섎떒 140px 而⑦듃濡??곸뿭??2?됱쑝濡?援ъ꽦
  - 1??70px): ?곹깭 ?⑤꼸
    - 諛붿퐫???? ?먮룞?몄떇 ?좉?, ?곹깭/寃곌낵 ?곸뿭, ?곗륫 ?먰삎 移댁슫??諭껋?(?대┃ ??移댁슫??珥덇린??
    - 移대찓???? ?곹깭 ?띿뒪??留덉?留?珥ъ쁺 寃곌낵 ?쒖떆), 珥ъ쁺 踰꾪듉, ?곗륫 ?먰삎 移댁슫??諭껋?(?대┃ ??移댁슫??珥덇린??
  - 2??70px): ??硫붾돱
    - 醫? Barcode Scan
    - ?? Camera Scan

### ?ㅼ틪/珥ъ쁺 ?숈옉 紐⑤뜽
- ?⑥씪 MobileScanner ?꾩젽?쇰줈 ?곸긽 ?ㅽ듃由??쒖텧
- 紐⑤뱶 ?꾪솚? ?섎떒 ???대┃?쇰줈 ?섑뻾(Barcode ??Camera)
- 紐⑤뱶???곕씪 ?곹깭 ?⑤꼸留?諛붾뚮ŉ, ?곸긽 ?덉씠?꾩썐? ?ъ궗??
  - Barcode 紐⑤뱶
    - ?먮룞(ON): 諛붿퐫??媛먯? ??利됱떆 泥섎━
    - ?섎룞(OFF): 諛붿퐫??媛먯? ???곹깭 ?⑤꼸??"?몄떇" 踰꾪듉 ?쒖떆 ??踰꾪듉 ?꾨Ⅴ硫?泥섎━
    - 理쒓렐 ?몄떇 寃곌낵瑜??뱀깋 ?쇱슫??諭껋?濡??쒖떆, ?섎떒??HH:mm:ss ?쒓컙 ?쒓린
  - Camera 紐⑤뱶
    - ?곹깭 ?⑤꼸??珥ъ쁺 踰꾪듉 ?몄텧(?곸긽 ???ㅻ쾭?덉씠 ?놁쓬)
    - 踰꾪듉 ?대┃ ??珥ъ쁺 ?대깽?몃? 寃곌낵濡?諛쒗뻾(?대?吏 ?뚯씪 ??μ? 梨낆엫 ??

### ?곹깭 ?좎? ?뺤콉
- ???꾪솚 ??留덉?留?寃곌낵(諛붿퐫???대?吏)瑜??곹깭 ?⑤꼸???좎??섏뿬 ?щ젋?붾쭅
- ?곸긽? ??긽 ?숈씪 ?덉씠?꾩썐???좎??섎?濡? 移대찓???쒖옉/?뺤?濡??명븳 ?ㅻ쪟(already started ??瑜??뚰뵾

### ScanService (?깃???
- ScanMode: barcode | camera
- isAutoMode: ?먮룞 ?몄떇 ?щ?(Barcode 紐⑤뱶?먯꽌留??섎?)
- Streams
  - barcodeStream: String (留덉?留??몄떇??諛붿퐫???곗씠???⑥쐞 ?대깽??
  - imageStream: String (珥ъ쁺 寃곌낵 ?앸퀎??寃쎈줈 臾몄옄???대깽??
- 理쒓렐 寃곌낵 蹂닿?
  - lastBarcodeResult: String, lastBarcodeTime: DateTime?
  - lastImageResult: String, lastImageTime: DateTime?
- 移댁슫????
  - barcodeCount, imageCount, totalCount
  - ?대? resultQueue(List<ScanResult>) 諛?3珥?二쇨린 紐⑹뾽 鍮꾨룞湲?泥섎━
    - ScanResult: { data, timestamp, type: 'barcode'|'image' }

#### ScanService 怨듦컻 API ?붿빟
- setMode(ScanMode mode): 紐⑤뱶 ?꾪솚(Barcode/Camera)
- setAutoMode(bool isAuto): ?먮룞 ?몄떇 on/off
- onBarcodeDetected(BarcodeCapture capture): MobileScanner??onDetect??諛붿씤??
- processManualBarcode(): ?섎룞 紐⑤뱶?먯꽌 ?湲?以?諛붿퐫??泥섎━
- captureImage(): Camera 紐⑤뱶?먯꽌 珥ъ쁺 ?대깽??諛쒗뻾(?대?吏 ??μ? ?몃? 梨낆엫)
- resetCounters(): ?몄떇 移댁슫??珥덇린??
- Streams: barcodeStream, imageStream

#### ?곗씠???먮쫫(Barcode / Auto ON)
1) MobileScanner.onDetect ??ScanService.onBarcodeDetected ?몄텧
2) 以묐났 ?꾪꽣(2珥? ??利됱떆 _processBarcodeResult
3) 理쒓렐 寃곌낵/?쒓컙 媛깆떊, 移댁슫??+1, ?먯뿉 異붽?, barcodeStream ?대깽??諛쒗뻾
4) ?곹깭 ?⑤꼸 諭껋?/?쒓컙/移댁슫???낅뜲?댄듃

#### ?곗씠???먮쫫(Barcode / Auto OFF)
1) onDetect ??pendingBarcodeData????????곹깭 ?⑤꼸??"?몄떇" 踰꾪듉 ?몄텧
2) ?ъ슜?먭? ?몄떇 踰꾪듉 ?대┃ ??processManualBarcode ??_processBarcodeResult

#### ?곗씠???먮쫫(Camera)
1) ?ъ슜?먭? 珥ъ쁺 踰꾪듉 ?대┃ ??captureImage ?몄텧
2) 理쒓렐 寃곌낵/?쒓컙 媛깆떊, 移댁슫??+1, ?먯뿉 異붽?, imageStream ?대깽??諛쒗뻾

#### ??泥섎━(紐⑹뾽)
- 3珥?二쇨린 ??대㉧濡??먯뿉??寃곌낵 1嫄댁뵫 爰쇰궡 濡쒓렇 泥섎━
- ?ㅼ젣 ?쒕쾭 ?꾩넚/?곴뎄 ??μ? 異뷀썑 ?④퀎?먯꽌 援ы쁽(???④퀎??紐⑹뾽)

### 二쇱쓽/?쒗븳
- ?대?吏 ???寃쎈줈/?뚯씪 I/O??ScanService 梨낆엫?먯꽌 ?쒖쇅(?곸쐞 UI/罹먯떛 ?쒕퉬?ㅼ뿉??泥섎━)
- SignalR 吏곸젒 ?곕룞? ?꾩쭅 FE???녾퀬, ?쇰컲 WebSocket ?쒕퉬?ㅺ? 蹂꾨룄 ?쒓났???섎떒 李몄“)

### WebSocketService (?쇰컲 WS)
- web_socket_channel 湲곕컲??寃쎈웾 WebSocket ?대씪?댁뼵??
- ?먮룞 ?ъ뿰寃?理쒕? 5??, ?섑듃鍮꾪듃(30珥?, 諛⑹넚??硫붿떆吏 ?≪닔??
- SignalR ?꾨줈?좎퐳? ?ъ슜?섏? ?딆쓬(諛깆뿏??ScannerHub???蹂꾧컻 寃쎈줈)

## 諛깆뿏??.NET 8 / ASP.NET Core)

### ?고????ы듃
- HTTP: http://localhost:51111
- HTTPS: https://localhost:51112
- CORS ?덉슜: http://127.0.0.1:58000, http://localhost:58000

### REST API
- Base: /api/scanner

1) GET /
   - 紐⑹쟻: ?ъ뒪泥댄겕
   - ?묐떟: { message: "Scanner API is running", timestamp: DateTime }

2) POST /scan
   - 紐⑹쟻: ?ㅼ틪 ?곗씠???섏떊 諛?釉뚮줈?쒖틦?ㅽ듃
   - ?붿껌 諛붾뵒:
```
{
  "data": "BARCODE_OR_TEXT",
  "deviceId": "optional",
  "userId": "optional"
}
```
   - ?묐떟 諛붾뵒:
```
{
  "id": "guid",
  "data": "BARCODE_OR_TEXT",
  "timestamp": "2025-09-12T12:34:56",
  "status": "Success"
}
```
   - 遺媛 ?숈옉: SignalR Hub瑜??듯빐 紐⑤뱺 ?대씪?댁뼵?몄뿉 ScanResult ?대깽??諛쒖넚

### SignalR Hub
- 寃쎈줈: /scannerhub
- 洹몃９ 愿由? JoinGroup(group), LeaveGroup(group)
- 釉뚮줈?쒖틦?ㅽ듃: SendMessage(user, message), SendScanResult(scanData), SendToGroup(group, message)
- ?곌껐 ?대깽?? UserConnected, UserDisconnected
- ?쒕쾭?믫겢?쇱씠?명듃 ?쒖? ?대깽??而⑦듃濡ㅻ윭?먯꽌???ъ슜)
  - "ScanResult": { id, data, timestamp, status }

### ?ㅼ젙(appsettings.json)
- 濡쒓퉭 ?덈꺼
- Kestrel Endpoints: 51111/51112 紐낆떆

## FE?볿E ?듭떊 ?꾨왂

### ?꾩옱
- FE??移대찓??諛붿퐫???ㅼ틪 濡쒖뺄 泥섎━ 諛???紐⑹뾽 泥섎━ 以묒떖
- BE??REST(POST /scan) 諛?SignalR ?덈툕 ?쒓났(釉뚮줈?쒖틦?ㅽ듃/洹몃９)
- FE???쇰컲 WebSocketService??踰붿슜 硫붿떆吏 ?섏떊??蹂꾨룄 ?쒕쾭/?곕え? ?곌껐 媛??

### 李⑦썑 沅뚯옣(?좏깮)
- FE??SignalR ?대씪?댁뼵???꾩엯?섏뿬 `/scannerhub` 吏곸젒 援щ룆
- ?ㅼ틪/珥ъ쁺 寃곌낵 ??泥섎━ ?꾨즺 ?쒖젏??BE?먭쾶 ?낅쭅??REST or Hub) ???쒕쾭 釉뚮줈?쒖틦?ㅽ듃 ?섏떊?쇰줈 FE媛??숆린??

## 媛쒕컻/?ㅽ뻾 諛⑸쾿

### 諛깆뿏??
1) ?대뜑: lnuniserverbe/LnUniScanBE
2) ?ㅽ뻾
```
dotnet restore
dotnet run
```
3) Swagger: 媛쒕컻 紐⑤뱶?먯꽌 /swagger

### ?꾨윴?몄뿏??
1) ?대뜑: lnuniscnnerfeapp/lnuniscnnerfeapp
2) ?ㅽ뻾
```
flutter pub get
flutter run
```

## 沅뚰븳/?뚮옯??李멸퀬

### Android
- Camera 沅뚰븳 ?꾩슂(?뚮윭洹몄씤???먮룞 泥섎━?섎굹, 留ㅻ땲?섏뒪???뺤씤 沅뚯옣)
- CameraX/MLKit 踰덈뱾/?몃쾲???좏깮 媛??(?⑦궎吏 臾몄꽌 李멸퀬)

### iOS/macOS
- Info.plist: NSCameraUsageDescription(?꾩닔), NSPhotoLibraryUsageDescription(媛ㅻ윭由??ъ슜 ??

### Web
- mobile_scanner 5.0.0+ 遺???ㅽ겕由쏀듃 ?먮룞 濡쒕뱶(?꾩닔 ?ㅽ겕由쏀듃 ?섎룞 異붽? 遺덊븘??

李멸퀬: mobile_scanner ?⑦궎吏 ?ъ슜踰?諛??쒖빟 ?ы빆? 怨듭떇 臾몄꽌瑜??뺤씤?섏떗?쒖삤. [mobile_scanner on pub.dev](https://pub.dev/packages/mobile_scanner)

## ?뚯뒪???쒕굹由ъ삤 泥댄겕由ъ뒪??
- Barcode Scan/Auto ON: 諛붿퐫??媛먯? 利됱떆 諭껋?/?쒓컙/移댁슫??媛깆떊
- Barcode Scan/Auto OFF: 諛붿퐫??媛먯? ???몄떇 踰꾪듉 ?쒖떆 ???대┃ ??媛깆떊
- Camera Scan: 珥ъ쁺 踰꾪듉 ?대┃ ??寃곌낵/?쒓컙/移댁슫??媛깆떊
- ???꾪솚: 理쒓렐 寃곌낵 ?좎?
- 移댁슫??諭껋? ?대┃: 移댁슫??0?쇰줈 珥덇린??
- ??鍮꾨룞湲?泥섎━: 3珥덈쭏??1嫄?泥섎━ 濡쒓렇 異쒕젰
- BE POST /scan: ?뺤긽 200 ?묐떟 諛?Hub 釉뚮줈?쒖틦?ㅽ듃 諛쒖깮

## 蹂寃??뺤옣 ?ъ씤??
- ?대?吏 ?뚯씪 ????몃꽕???앹꽦 濡쒖쭅: 蹂꾨룄 罹먯떛 ?쒕퉬?ㅻ줈 遺꾨━ 援ы쁽
- ??泥섎━湲? ?ㅼ젣 ?쒕쾭 ?낅쭅??諛??ъ떆???꾨왂 異붽?
- FE SignalR ?대씪?댁뼵???곌퀎: Hub ?대깽??諛붿씤?⑹쑝濡??곹깭 ?숆린??

---
臾몄꽌 踰꾩쟾: 2025-09-12
?묒꽦 洹쇨굅: ?꾩옱 由ы룷吏?좊━??FE/BE ?뚯뒪 肄붾뱶 諛?mobile_scanner 怨듭떇 臾몄꽌 [mobile_scanner on pub.dev](https://pub.dev/packages/mobile_scanner)


#UNISCAN
-諛붿퐫??移대찓???ㅼ틪???듯빐 諛붿퐫???곸닔利??쇰꺼 ?댁슜??吏묎퀎
-諛붿퐫?쒖쓽 寃쎌슦 PC???먯씠?꾪듃瑜??ㅼ튂?섍퀬 ?ㅻ낫?쒗썑?뱀쑝濡?諛붿퐫?쒖뒪罹먮꼫泥섎읆 肄붾뱶?낅젰??蹂대궪 ???덉쓬
-PC???ㅼ튂???꾨┛??諛붿퐫?쒗봽由고꽣,?쇰컲)???몄뇙瑜?蹂대궪 ???덉쓬
-愿由??ъ씠?몃? ?듯빐 諛붿퐫?쒖뿉 ????쒗뭹 愿由? ?ш퀬 愿由? ?낃퀬/異쒓퀬/?앹궛/?ъ슜/遺덈웾 ?≪뀡 媛??

