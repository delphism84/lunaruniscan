## UniScan FE/BE 疫꿸퀡???닌딄쉐 ?얜챷苑?

筌〓㈇?? ?袁⑷퍥 ?닌듼??怨멸쉭 ??블??`uniscan-structure.md`???類ㅼ뵥??뤾쉭??

### 雅뚯눘???癒?カ ?遺용튋(?遺쎈럡??鍮??類ｂ봺)
- Barcode ??쇳떔 ???紐꾨뻼 ??源????筌?Ŋ??獄쏅뗄??? ?源낆쨯
- Camera ?Ρ딆겫 ???Ρ딆겫 ??源????筌?Ŋ????彛? ?源낆쨯

### ?꾨뗀諭?: 獄쏅뗄?????쇳떔 ??깆뵠?됰슢??뵳??????袁⑹삺 ??덉삂 + ?④쑵??
- ??????깆뵠?됰슢??뵳? `mobile_scanner`
- 獄쏅뗄??? `MobileScanner.onDetect ??ScanService.onBarcodeDetected ??EnhancedScanService.addBarcode`
- 燁삳?李?? Camera ??肉???Ρ딆겫 甕곌쑵????`ScanService.captureImage ??EnhancedScanService.addImagePlaceholder`
  - ???怨밴묶: ??쇱젫 ???뵬 ??????곸뵠 placeholder ?源낆쨯
  - ?④쑵?? ??쇱젫 ?Ρ딆겫 ???뵬 ?????癒?뮉 ?醫뤾문) ??筌?Ŋ????뺥돩??쇰퓠 ???뵬 野껋럥以??袁⑤뼎

### ?꾨뗀諭?: 筌?Ŋ???온???袁⑹삺 ??덉삂 + ?④쑵??
- ???怨밴묶(筌롫뗀?덄뵳?筌?Ŋ??:
  - `EnhancedScanService`揶쎛 `IScanItem` 筌뤴뫖以?獄쏅뗄??????筌왖)??筌롫뗀?덄뵳?肉??醫?
  - 餓λ쵎??獄쏅뗄????袁り숲(疫꿸퀡??5??: ??덉뵬 獄쏅뗄????怨쀫꺗 ?紐꾨뻼 獄쎻뫗?, ??쇱젟/?λ뜃由??揶쎛??
- ?④쑵?????뵬 筌?Ŋ??+ ??낆쨮??:
  - 筌?Ŋ???源낆쨯: ??쇳떔 ?袁⑹뵠??뽰뱽 ???뵬嚥???밴쉐/癰귣떯?
    - type: `barcode | image`
    - content: 獄쏅뗄?????용뮞???癒?뮉 ???筌왖 ???뵬(`png/jpg`)
  - 筌?Ŋ????낆쨮?? BE API嚥??袁⑤뼎??렽?筌욊쑵六양몴???뽯뻻
    - ?源껊궗: 筌?Ŋ?????뵬 ???? 疫꿸퀡以됵쭕?癰귣똻??
    - ??쎈솭: ?????獄쏄퉮??? ??쎈솭 疫꿸퀡以??醫?

### UniScanAgent ?온???袁⑥쑕?紐꾨퓦??
- BE?癒?퐣 ?源낆쨯???癒?뵠?袁る뱜(PC ??쇳뒄?? 筌뤴뫖以?鈺곌퀬????뽯뻻
- 獄쏅뗄???????筌ｌ꼶???? ??????醫뤾문(ON)???癒?뵠?袁る뱜嚥??袁⑤뼎??????덈즲嚥???깆뒭????쇱젟

### 獄쏄퉮肉??筌ｌ꼶???癒?뒅(????낇?
- ???筌왖 ????
  - ????野껋럥以? `BE ??쎈뻬 ????files/images/{userId}/{yyyyMMdd}/{yyyyMMdd-HHmmss_??뺣쑁}.jpg`
  - DB 疫꿸퀡以?筌롫??: userId, ???뵬 野껋럥以? ??낆쨮????볦퍟, ?怨밴묶)
  - ????ｍ? ??由경틦?? ?닌뗭겱 ????꾩뜎??TODO嚥????
- 獄쏅뗄???????
  - DB 疫꿸퀡以??怨쀬뵠?? userId, ??볦퍟, ?怨밴묶)
  - ?癒?뵠?袁る뱜 ON ?怨밴묶?????怨몃퓠野?WS ?紐꾨??곗쨮 ?袁⑸꽊
  - ?袁⑸꽊 ?袁⑥┷ ??DB ack 揶쏄퉮??

### UniScanAgent(?遺쎈럡??鍮?
- C# .NET Framework 4.x
- ?袁⑸열 ?袁り때(??삳궖??筌띾뜆???
- BE?癒?퐣 scanitem ??뤿뻿 ????삳궖????낆젾 ?醫륁깈嚥??????獄쏅뗄?????쇳떐????ｋ궢 ??볥궗
- ??ｋ궢????源?Agent ??ON/OFF), ?ル슣瑜??롫뼊 ?癒?퍥 ?醫롫뮞??ON/OFF)
- Tray ?袁⑹뵠?? Inno Setup ??쇳뒄, ??뺥돩??살쨮 ?닌됰짗


### 筌뤴뫗??
UniScan ??뽯뮞??뽰벥 ?袁⑥쑕?紐꾨퓦??Flutter)?? 獄쏄퉮肉??.NET) ?닌딄쉐, ?怨쀬뵠???癒?カ, API/HUB ??堉? ??쎈뻬 獄쎻뫖苡?????얜챷苑???類ｂ봺??뺣뼄.

## ?袁⑥쑕?紐꾨퓦??Flutter)

### ?怨???????
- FE 揶쏆뮆而???뺤쒔: http://127.0.0.1:58000 (??????醫륁깈 ??쇱젟)
- 揶쏆뮆而???뺤쒔 IP : 175.100.115.114

### 雅뚯눘????뤵??
- 燁삳?李??獄쏅뗄??? mobile_scanner ???쑎域밸챷?????? ??μ뵬 ?袁⑹졐 疫꿸퀡而???λ떄 ?닌듼쒏에??닌뗭겱?? [筌뤴뫀諭??얜챷苑?(https://pub.dev/packages/mobile_scanner)

### ?遺얇늺/UX ?닌딄쉐
- ??μ뵬 燁삳?李??沃섎챶?곮퉪?용┛ ??됱뵠?袁⑹뜍 ?怨룸뼊(Expanded) ?⑥쥙??
- ??롫뼊 140px ?뚢뫂?껅에??怨몃열??2??깆몵嚥??닌딄쉐
  - 1??70px): ?怨밴묶 ??ㅺ섯
    - 獄쏅뗄????? ?癒?짗?紐꾨뻼 ?醫?, ?怨밴묶/野껉퀗???怨몃열, ?怨쀫? ?癒곗굨 燁삳똻???獄?퍔?(??????燁삳똻????λ뜃由??
    - 燁삳?李???? ?怨밴묶 ??용뮞??筌띾뜆?筌??Ρ딆겫 野껉퀗????뽯뻻), ?Ρ딆겫 甕곌쑵?? ?怨쀫? ?癒곗굨 燁삳똻???獄?퍔?(??????燁삳똻????λ뜃由??
  - 2??70px): ??筌롫뗀??
    - ?? Barcode Scan
    - ?? Camera Scan

### ??쇳떔/?Ρ딆겫 ??덉삂 筌뤴뫀??
- ??μ뵬 MobileScanner ?袁⑹졐??곗쨮 ?怨멸맒 ??쎈뱜????뽱뀱
- 筌뤴뫀諭??袁れ넎?? ??롫뼊 ???????곗쨮 ??묐뻬(Barcode ??Camera)
- 筌뤴뫀諭???怨뺤뵬 ?怨밴묶 ??ㅺ섯筌?獄쏅뗀???? ?怨멸맒 ??됱뵠?袁⑹뜍?? ??沅??
  - Barcode 筌뤴뫀諭?
    - ?癒?짗(ON): 獄쏅뗄???揶쏅Ŋ? ??筌앸맩??筌ｌ꼶??
    - ??롫짗(OFF): 獄쏅뗄???揶쏅Ŋ? ???怨밴묶 ??ㅺ섯??"?紐꾨뻼" 甕곌쑵????뽯뻻 ??甕곌쑵???袁ⓥ뀮筌?筌ｌ꼶??
    - 筌ㅼ뮄???紐꾨뻼 野껉퀗?든몴??諭源???깆뒲??獄?퍔?嚥???뽯뻻, ??롫뼊??HH:mm:ss ??볦퍢 ??볥┛
  - Camera 筌뤴뫀諭?
    - ?怨밴묶 ??ㅺ섯???Ρ딆겫 甕곌쑵???紐꾪뀱(?怨멸맒 ????살쒔??됱뵠 ??곸벉)
    - 甕곌쑵?????????Ρ딆겫 ??源?紐? 野껉퀗?득에?獄쏆뮉六????筌왖 ???뵬 ???關? 筌?굞????

### ?怨밴묶 ?醫? ?類ㅼ퐠
- ???袁れ넎 ??筌띾뜆?筌?野껉퀗??獄쏅뗄??????筌왖)???怨밴묶 ??ㅺ섯???醫???뤿연 ????遺얠춦
- ?怨멸맒?? ??湲???덉뵬 ??됱뵠?袁⑹뜍???醫????嚥? 燁삳?李????뽰삂/?類?嚥??紐낅립 ??살첒(already started ??????곕돗

### ScanService (?源???
- ScanMode: barcode | camera
- isAutoMode: ?癒?짗 ?紐꾨뻼 ???(Barcode 筌뤴뫀諭?癒?퐣筌????)
- Streams
  - barcodeStream: String (筌띾뜆?筌??紐꾨뻼??獄쏅뗄????怨쀬뵠????μ맄 ??源??
  - imageStream: String (?Ρ딆겫 野껉퀗????명??野껋럥以??얜챷?????源??
- 筌ㅼ뮄??野껉퀗??癰귣떯?
  - lastBarcodeResult: String, lastBarcodeTime: DateTime?
  - lastImageResult: String, lastImageTime: DateTime?
- 燁삳똻?????
  - barcodeCount, imageCount, totalCount
  - ??? resultQueue(List<ScanResult>) 獄?3??雅뚯눊由?筌뤴뫗毓???쑬猷욄묾?筌ｌ꼶??
    - ScanResult: { data, timestamp, type: 'barcode'|'image' }

#### ScanService ?⑤벀而?API ?遺용튋
- setMode(ScanMode mode): 筌뤴뫀諭??袁れ넎(Barcode/Camera)
- setAutoMode(bool isAuto): ?癒?짗 ?紐꾨뻼 on/off
- onBarcodeDetected(BarcodeCapture capture): MobileScanner??onDetect??獄쏅뗄???
- processManualBarcode(): ??롫짗 筌뤴뫀諭?癒?퐣 ??疫?餓?獄쏅뗄???筌ｌ꼶??
- captureImage(): Camera 筌뤴뫀諭?癒?퐣 ?Ρ딆겫 ??源??獄쏆뮉六????筌왖 ???關? ?紐? 筌?굞??
- resetCounters(): ?紐꾨뻼 燁삳똻????λ뜃由??
- Streams: barcodeStream, imageStream

#### ?怨쀬뵠???癒?カ(Barcode / Auto ON)
1) MobileScanner.onDetect ??ScanService.onBarcodeDetected ?紐꾪뀱
2) 餓λ쵎???袁り숲(2?? ??筌앸맩??_processBarcodeResult
3) 筌ㅼ뮄??野껉퀗????볦퍢 揶쏄퉮?? 燁삳똻???+1, ?癒?퓠 ?곕떽?, barcodeStream ??源??獄쏆뮉六?
4) ?怨밴묶 ??ㅺ섯 獄?퍔?/??볦퍢/燁삳똻?????낅쑓??꾨뱜

#### ?怨쀬뵠???癒?カ(Barcode / Auto OFF)
1) onDetect ??pendingBarcodeData?????????怨밴묶 ??ㅺ섯??"?紐꾨뻼" 甕곌쑵???紐꾪뀱
2) ????癒? ?紐꾨뻼 甕곌쑵????????processManualBarcode ??_processBarcodeResult

#### ?怨쀬뵠???癒?カ(Camera)
1) ????癒? ?Ρ딆겫 甕곌쑵????????captureImage ?紐꾪뀱
2) 筌ㅼ뮄??野껉퀗????볦퍢 揶쏄퉮?? 燁삳똻???+1, ?癒?퓠 ?곕떽?, imageStream ??源??獄쏆뮉六?

#### ??筌ｌ꼶??筌뤴뫗毓?
- 3??雅뚯눊由??????㎪에??癒?퓠??野껉퀗??1椰꾨똻逾??곗눖沅?嚥≪뮄??筌ｌ꼶??
- ??쇱젫 ??뺤쒔 ?袁⑸꽊/?怨대럡 ???關? ?곕?????ｍ?癒?퐣 ?닌뗭겱(????ｍ??筌뤴뫗毓?

### 雅뚯눘????쀫립
- ???筌왖 ????野껋럥以????뵬 I/O??ScanService 筌?굞??癒?퐣 ??뽰뇚(?怨몄맄 UI/筌?Ŋ????뺥돩??쇰퓠??筌ｌ꼶??
- SignalR 筌욊낯???怨뺣짗?? ?袁⑹춦 FE????얩? ??곗뺘 WebSocket ??뺥돩??? 癰귢쑬猷???볥궗????롫뼊 筌〓챷??

### WebSocketService (??곗뺘 WS)
- web_socket_channel 疫꿸퀡而??野껋럥??WebSocket ?????곷섧??
- ?癒?짗 ??肉겼칰?筌ㅼ뮆? 5??, ??묐뱜??쑵??30??, 獄쎻뫗???筌롫뗄?놅쭪? ??る땾??
- SignalR ?袁⑥쨮?醫롰맫?? ?????? ??놁벉(獄쏄퉮肉??ScannerHub????癰귢쑨而?野껋럥以?

## 獄쏄퉮肉??.NET 8 / ASP.NET Core)

### ?怨???????
- HTTP: http://localhost:51111
- HTTPS: https://localhost:51112
- CORS ??됱뒠: http://127.0.0.1:58000, http://localhost:58000

### REST API
- Base: /api/scanner

1) GET /
   - 筌뤴뫗?? ???わ㎗?꾧쾿
   - ?臾먮뼗: { message: "Scanner API is running", timestamp: DateTime }

2) POST /scan
   - 筌뤴뫗?? ??쇳떔 ?怨쀬뵠????뤿뻿 獄??됰슢以??뽱떐??쎈뱜
   - ?遺욧퍕 獄쏅뗀逾?
```
{
  "data": "BARCODE_OR_TEXT",
  "deviceId": "optional",
  "userId": "optional"
}
```
   - ?臾먮뼗 獄쏅뗀逾?
```
{
  "id": "guid",
  "data": "BARCODE_OR_TEXT",
  "timestamp": "2025-09-12T12:34:56",
  "status": "Success"
}
```
   - ?봔揶쎛 ??덉삂: SignalR Hub?????퉸 筌뤴뫀諭??????곷섧?紐꾨퓠 ScanResult ??源??獄쏆뮇??

### SignalR Hub
- 野껋럥以? /scannerhub
- 域밸챶竊??온?? JoinGroup(group), LeaveGroup(group)
- ?됰슢以??뽱떐??쎈뱜: SendMessage(user, message), SendScanResult(scanData), SendToGroup(group, message)
- ?怨뚭퍙 ??源?? UserConnected, UserDisconnected
- ??뺤쒔?誘リ깻??깆뵠?紐낅뱜 ??? ??源???뚢뫂?껅에?살쑎?癒?퐣??????
  - "ScanResult": { id, data, timestamp, status }

### ??쇱젟(appsettings.json)
- 嚥≪뮄????덇볼
- Kestrel Endpoints: 51111/51112 筌뤿굞??

## FE?蹂풢 ???뻿 ?袁⑥셽

### ?袁⑹삺
- FE??燁삳?李??獄쏅뗄?????쇳떔 嚥≪뮇類?筌ｌ꼶??獄???筌뤴뫗毓?筌ｌ꼶??餓λ쵐??
- BE??REST(POST /scan) 獄?SignalR ??덊닏 ??볥궗(?됰슢以??뽱떐??쎈뱜/域밸챶竊?
- FE????곗뺘 WebSocketService??甕곕뗄??筌롫뗄?놅쭪? ??뤿뻿??癰귢쑬猷???뺤쒔/?怨뺛걟?? ?怨뚭퍙 揶쎛??

### 筌△뫂??亦낅슣???醫뤾문)
- FE??SignalR ?????곷섧???袁⑹뿯??뤿연 `/scannerhub` 筌욊낯???닌됰즴
- ??쇳떔/?Ρ딆겫 野껉퀗????筌ｌ꼶???袁⑥┷ ??뽰젎??BE?癒?쓺 ??낆춦??REST or Hub) ????뺤쒔 ?됰슢以??뽱떐??쎈뱜 ??뤿뻿??곗쨮 FE揶???녿┛??

## 揶쏆뮆而???쎈뻬 獄쎻뫖苡?

### 獄쏄퉮肉??
1) ???? lnuniserverbe/node-api
2) ??쎈뻬
```
dotnet restore
dotnet run
```
3) Swagger: 揶쏆뮆而?筌뤴뫀諭?癒?퐣 /swagger

### ?袁⑥쑕?紐꾨퓦??
1) ???? lnuniscnnerfeapp/lnuniscnnerfeapp
2) ??쎈뻬
```
flutter pub get
flutter run
```

## 亦낅슦釉????삸??筌〓㈇??

### Android
- Camera 亦낅슦釉??袁⑹뒄(???쑎域밸챷????癒?짗 筌ｌ꼶???롪돌, 筌띲끇???뤿뮞???類ㅼ뵥 亦낅슣??
- CameraX/MLKit 甕곕뜄諭??紐껋쓰???醫뤾문 揶쎛??(???텕筌왖 ?얜챷苑?筌〓㈇??

### iOS/macOS
- Info.plist: NSCameraUsageDescription(?袁⑸땾), NSPhotoLibraryUsageDescription(揶쎼끇??뵳???????

### Web
- mobile_scanner 5.0.0+ ?봔????쎄쾿?깆????癒?짗 嚥≪뮆諭??袁⑸땾 ??쎄쾿?깆?????롫짗 ?곕떽? ?븍뜇釉??

筌〓㈇?? mobile_scanner ???텕筌왖 ???쒑린?獄???뽯튋 ??鍮?? ?⑤벊???얜챷苑뚨몴??類ㅼ뵥??뤿뼏??뽰궎. [mobile_scanner on pub.dev](https://pub.dev/packages/mobile_scanner)

## ???뮞????뺢돌?귐딆궎 筌ｋ똾寃뺟뵳????
- Barcode Scan/Auto ON: 獄쏅뗄???揶쏅Ŋ? 筌앸맩??獄?퍔?/??볦퍢/燁삳똻???揶쏄퉮??
- Barcode Scan/Auto OFF: 獄쏅뗄???揶쏅Ŋ? ???紐꾨뻼 甕곌쑵????뽯뻻 ????????揶쏄퉮??
- Camera Scan: ?Ρ딆겫 甕곌쑵????????野껉퀗????볦퍢/燁삳똻???揶쏄퉮??
- ???袁れ넎: 筌ㅼ뮄??野껉퀗???醫?
- 燁삳똻???獄?퍔? ???? 燁삳똻???0??곗쨮 ?λ뜃由??
- ????쑬猷욄묾?筌ｌ꼶?? 3?λ뜄彛??1椰?筌ｌ꼶??嚥≪뮄???곗뮆??
- BE POST /scan: ?類ㅺ맒 200 ?臾먮뼗 獄?Hub ?됰슢以??뽱떐??쎈뱜 獄쏆뮇源?

## 癰궰野??類ㅼ삢 ?????
- ???筌왖 ???뵬 ?????紐껉퐬????밴쉐 嚥≪뮇彛? 癰귢쑬猷?筌?Ŋ????뺥돩??살쨮 ?브쑬???닌뗭겱
- ??筌ｌ꼶?곫묾? ??쇱젫 ??뺤쒔 ??낆춦??獄???????袁⑥셽 ?곕떽?
- FE SignalR ?????곷섧???怨뚰? Hub ??源??獄쏅뗄???뱀몵嚥??怨밴묶 ??녿┛??

---
?얜챷苑?甕곌쑴?? 2025-09-12
?臾믨쉐 域뱀눊援? ?袁⑹삺 ?귐뗫７筌왖?醫듼봺??FE/BE ???뮞 ?꾨뗀諭?獄?mobile_scanner ?⑤벊???얜챷苑?[mobile_scanner on pub.dev](https://pub.dev/packages/mobile_scanner)


#UNISCAN
-獄쏅뗄???燁삳?李????쇳떔?????퉸 獄쏅뗄????怨몃땾筌???곌볼 ??곸뒠??筌욌쵌??
-獄쏅뗄???뽰벥 野껋럩??PC???癒?뵠?袁る뱜????쇳뒄??랁???삳궖??쀬뜎?諭?앮에?獄쏅뗄???뽯뮞筌?Ŧ瑗ワ㎗?롮쓥 ?꾨뗀諭??낆젾??癰귣?沅?????됱벉
-PC????쇳뒄???袁ⓥ뵛??獄쏅뗄???쀫늄?깃퀬苑???곗뺘)???紐꾨뇵??癰귣?沅?????됱벉
-?온??????紐? ???퉸 獄쏅뗄???뽯퓠 ??????쀫? ?온?? ?????온?? ??껎??곗뮄????밴텦/?????븍뜄????る?揶쎛??

